<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.back.travelit.mapper.product.ProductMapper">

    <!-- 상품 목록 조회 -->
    <select id="findAll" resultType="com.back.travelit.dto.response.product.ProductResponse">
        SELECT
            PRO_ID,
            USER_ID,
            PRO_NAME,
            PRO_CATEGORY_TOTAL,
            PRO_CATEGORY_DETAIL,
            PRO_CONTENT,
            PRO_RES,
            PRO_PRICE,
            PRO_PER_MAX,
            PRO_DATE,
            PRO_LOCATION,
            PRO_VIEW,
            TOUR_DATE,
            TOUR_TIME,
            TOUR_START,
            TOUR_END
        FROM
            PRODUCT
        ORDER BY
            PRO_ID DESC
        LIMIT #{productPagination.limitStart}, #{recordSize}
    </select>

    <!-- 상품 상세 조회 -->
    <select id="findById" parameterType="int" resultType="com.back.travelit.dto.response.product.ProductResponse">
        SELECT
            PRO_ID,
            USER_ID,
            PRO_NAME,
            PRO_CATEGORY_TOTAL,
            PRO_CATEGORY_DETAIL,
            PRO_CONTENT,
            PRO_RES,
            PRO_PRICE,
            PRO_PER_MAX,
            PRO_DATE,
            PRO_LOCATION,
            PRO_VIEW,
            TOUR_DATE,
            TOUR_TIME,
            TOUR_START,
            TOUR_END
        FROM
            PRODUCT
        WHERE
            PRO_ID = #{value};
    </select>

    <!-- 상품 등록 -->
    <insert id="save" parameterType="com.back.travelit.dto.request.product.ProductRequest" useGeneratedKeys="true">
        INSERT INTO PRODUCT (PRO_ID, USER_ID, PRO_NAME, PRO_CATEGORY_TOTAL, PRO_CATEGORY_DETAIL, PRO_CONTENT,
                             PRO_RES, PRO_PRICE, PRO_PER_MAX, PRO_DATE, PRO_LOCATION, PRO_VIEW, TOUR_DATE, TOUR_TIME,
                             TOUR_START, TOUR_END)
        VALUES (#{PRO_ID}, 1, #{PRO_NAME}, #{PRO_CATEGORY_TOTAL}, #{PRO_CATEGORY_DETAIL}, #{PRO_CONTENT},
                #{PRO_RES}, #{PRO_PRICE}, #{PRO_PER_MAX}, DEFAULT, #{PRO_LOCATION}, DEFAULT, #{TOUR_DATE}, #{TOUR_TIME},
                #{TOUR_START}, #{TOUR_END})
    </insert>

    <!-- 상품 수정 등록 -->
    <update id="update" parameterType="com.back.travelit.dto.request.product.ProductRequest">
        UPDATE PRODUCT
        SET USER_ID = 1,
            PRO_NAME = #{PRO_NAME},
            PRO_CATEGORY_TOTAL = #{PRO_CATEGORY_TOTAL},
            PRO_CATEGORY_DETAIL = #{PRO_CATEGORY_DETAIL},
            PRO_CONTENT = #{PRO_CONTENT},
            PRO_RES = #{PRO_RES},
            PRO_PRICE = #{PRO_PRICE},
            PRO_PER_MAX = #{PRO_PER_MAX},
            PRO_DATE = DEFAULT,
            PRO_LOCATION = #{PRO_LOCATION},
            PRO_VIEW = DEFAULT,
            TOUR_DATE = #{TOUR_DATE},
            TOUR_TIME = #{TOUR_TIME},
            TOUR_START = #{TOUR_START},
            TOUR_END = #{TOUR_END}
        WHERE PRO_ID = #{PRO_ID}
    </update>

    <!-- 상품 삭제 -->
    <delete id="deleteById" parameterType="int">
        DELETE
        FROM PRODUCT
        WHERE PRO_ID = #{PRO_ID}
    </delete>

    <!-- 전체 상품 수 조회 -->
    <select id="count" resultType="int">
        SELECT
            COUNT(*)
        FROM
            PRODUCT
    </select>

</mapper>